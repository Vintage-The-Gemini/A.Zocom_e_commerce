# Turn on the rewrite engine
RewriteEngine On

# Ensure mod_rewrite is enabled
<IfModule mod_rewrite.c>
    # Handle www to non-www redirect (optional)
    RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
    RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
    
    # If requested resource exists as a file or directory, skip the following rules
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]
    
    # Redirect requests with .php extension to non-php URLs
    RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
    RewriteRule ^ /%1 [R=301,NE,L]
    
    # Internally rewrite clean URLs to their PHP scripts
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteRule ^(.+?)/?$ $1.php [L]
</IfModule>

# Set default index file
DirectoryIndex index.php

# Disable directory browsing
Options -Indexes

# Set default character set
AddDefaultCharset UTF-8